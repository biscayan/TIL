# Chapter 6. 전송 계층 : 신뢰할 수 있는 데이터 전송하기

## Lesson 23. 전송 계층의 역할
- 전송 계층은 목적지에 신뢰할 수 있는 데이터를 전달하기 위하여 필요하다.  
- 전송 계층에는 오류를 점검하는 기능이 있어서 오류가 발생하면 데이터를 재전송하도록 요청한다.  
- 전송 계층에는 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별하는 기능도 있다.  
- 전송 계층의 특징을 간단히 신뢰성/정확성과 효율성으로 구분할 수 있다.  
- 신뢰할 수 있고 정확한 데이터를 전달하는 통신을 연결형 통신이라고 하고, 효율적으로 데이터를 전달하는 통신을 비연결형 통신이라고 한다.  
- 동영상은 신뢰할 수 있고 정확한 데이터 전송보다 빠른 전송을 필요로 하기 때문에 비연결형 통신을 사용한다.  
- 연결형 통신 프로토콜에는 TCP가 사용되고, 비연결형 통신 프로토콜에는 UDP가 사용된다.  

## Lesson 24. TCP의 구조
- TCP로 전송할 때 붙이는 헤더를 TCP헤더라고 하며, 이 TCP 헤더가 붙은 데이터를 세그먼트라고 한다.  
- TCP 헤더에는 목적지까지 데이터를 제대로 전송하기 위해 필요한 정보를 가지고 있다.  
- TCP 헤더의 코드 비트에는 연결의 제어 정보가 기록된다.  
- 코드 비트의 초기값은 0이고 비트가 활성화되면 1이 된다.  
- 연결을 확립하려면 코드 비트에서 SYN (연결 요청)과 ACK (확인 응답)가 필요하다.  
- 3 way 핸드셰이크
    (1) 통신을 하려면 컴퓨터 2에게 허가를 받아야 하므로, 먼저 컴퓨터 1에서 컴퓨터 2로 연결 확립 허가를 받기 위한 요청을 보낸다.  
    (2) 컴퓨터 2는 컴퓨터 1이 보낸 요청을 받은 후에 허가한다는 응답을 회신하기 위해 연결 확립 응답을 보낸다. 동시에 컴퓨터 2도 컴퓨터 1에세 데이터 전송허가를 받기 위해 연결 확립 요청을 보낸다.  
    (3) 컴퓨터 2의 요청을 받은 컴퓨터 1은 컴퓨터 2로 허가한다는 응답으로 연결 확립 응답을 보낸다.  
- 연결을 끊을 때는 FIN (연결 종료)과 ACK (확인 응답)을 사용한다.  

## Lesson 25. 일렬번호와 확인 응답 번호의 구조
- 3-way 핸드셰이크가 끝나고 실제 데이터를 보내거나 상대방이 받을 때는 TCP 헤더의 일련번호와 확인 응답 번호를 사용한다.  
- 일련번호는 송신 측에서 수신 측에 이 데이터가 몇 번째 데이터인지 알려주는 역할을 한다.  
- 확인 응답 번호는 수식 측이 몇 번째 데이터를 수신했는지 송신 측에 알려주는 역할을 한다.  
- 재전송 제어 : 일련번호와 확인 응답 번호를 사용해서 데이터가 손상되거나 유실된 경우에 데이터를 재전송하는 것  
- 버퍼 : 세그먼트를 일시적으로 보관하는 장소  
- 오버플로 : 수신 측에 대량으로 데이터가 전송되어 보관하지 못하고 넘쳐 버리는 것  
- 윈도우 크기 : 얼마나 많은 용량의 데이터를 저장해 둘 수 있는지를 나타내는 것  
- 3-way 핸드셰이크를 하는 동안에 서로의 윈도우 크기를 확인한다.  
- 수신 측이 넉넉한 윈도우 크기를 가지고 있다면 확인 응답을 받지 않고도 세그먼트를 연속적으로 전송할 수 있다.  

## Lesson 26. 포트 번호의 구조
- TCP 헤더에 포트 번호가 있기 때문에 어떤 애플리케이션으로 데이터를 보내야 할지 구분할 수 있다.  
- 포트 번호는 0 ~ 65535번을 사용할 수 있다.  
- 0 ~ 1023번 포트는 주요 프로토콜이 사용하도록 예약되어 있는 well-known ports이다. 1024번은 예약되어 있지만 사용되지 않는 포트고, 1025번 이상은 랜텀 포트라고 해서 클라이언트 측의 송신 포트로 사용된다.  
- 0 ~ 1023번 포트는 서버 측 애플리케이션에서 사용된다.  
- 데이터를 전송할 때는 상대방의 IP 주소가 필요하지만, 어떤 애플리케이션이 사용되고 있는지 구분하려면 포트 번호가 필요하다.  

## Lesson 27. UDP의 구조
- UDP는 TCP와 달리 효율성을 중요하게 여기는 프로토콜이다.  
- UDP는 데이터를 효율적으로 빠르게 보낼 수 있어서 스트리밍 방식으로 전송하는 동영상 서비스와 같은 곳에서 사용된다.  
- UDP 헤더가 붙은 데이터를 UDP 데이터그램이라고 한다.  
- UDP에서는 브로드캐스트를 이용한 일괄 통신이 가능하다.  